<div 
  class="modal fade" 
  [id]="modalId" 
  tabindex="-1" 
  [attr.aria-labelledby]="modalId + 'Label'" 
  aria-hidden="true"
  (show.bs.modal)="onModalShow($event)"
  (hide.bs.modal)="onModalHide()"
  (hidden.bs.modal)="onModalHidden()">
  
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" [id]="modalId + 'Label'">
          <i class="fas fa-flag me-2"></i>
          Report {{ reportType === 'POST' ? 'Post' : 'User' }} (ID: {{ reportTargetId }})
        </h5>
        <button 
          type="button" 
          class="btn-close" 
          data-bs-dismiss="modal" 
          aria-label="Close"
          (click)="onCancel()"></button>
      </div>
      
      <form [formGroup]="reportForm" (ngSubmit)="onSubmit()">
        <div class="modal-body">
          <p>
            <i class="fas fa-info-circle me-2 text-warning"></i>
            Please provide a detailed reason for reporting this {{ reportType === 'POST' ? 'content' : 'user' }}. 
            Your report is confidential and will be reviewed by our moderation team.
          </p>
          
          <div class="alert alert-warning" role="alert">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <strong>Note:</strong> Other posts will be dimmed in the background to help you focus on this report.
          </div>
          
          <div class="form-group mt-4">
            <label for="reportReason">
              <i class="fas fa-pen me-2"></i>
              Reason for Report:
            </label>
            <textarea 
              id="reportReason" 
              formControlName="reason" 
              class="form-control" 
              rows="5"
              placeholder="Please provide specific details about why you're reporting this {{ reportType === 'POST' ? 'post' : 'user' }} (e.g., Offensive content, spam, harassment, inappropriate behavior, etc.)"
              [class.is-invalid]="reportForm.get('reason')?.invalid && reportForm.get('reason')?.touched"
              autofocus>
            </textarea>
            <div class="d-flex justify-content-between mt-2">
              <small class="text-muted">
                Minimum 10 characters, maximum 500 characters
              </small>
              <small [class.text-danger]="reportForm.get('reason')?.value?.length > 500">
                {{ reportForm.get('reason')?.value?.length || 0 }}/500
              </small>
            </div>
            <div class="invalid-feedback" *ngIf="reportForm.get('reason')?.invalid && reportForm.get('reason')?.touched">
              <span *ngIf="reportForm.get('reason')?.errors?.['required']">
                <i class="fas fa-times-circle me-1"></i>A reason is required.
              </span>
              <span *ngIf="reportForm.get('reason')?.errors?.['minlength']">
                <i class="fas fa-times-circle me-1"></i>Please provide at least 10 characters.
              </span>
              <span *ngIf="reportForm.get('reason')?.errors?.['maxlength']">
                <i class="fas fa-times-circle me-1"></i>Reason must be under 500 characters.
              </span>
            </div>
          </div>
        </div>
        
        <div class="modal-footer">
          <button 
            type="button" 
            class="btn btn-secondary" 
            data-bs-dismiss="modal"
            (click)="onCancel()">
            <i class="fas fa-times me-2"></i>
            Cancel
          </button>
          <button 
            type="submit" 
            class="btn btn-danger" 
            [disabled]="reportForm.invalid || isLoading">
            <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2" role="status"></span>
            <i class="fas fa-paper-plane me-2" *ngIf="!isLoading"></i>
            {{ isLoading ? 'Submitting...' : 'Submit Report' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>