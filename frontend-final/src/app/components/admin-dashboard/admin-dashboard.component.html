<!-- Admin Dashboard Component - All Sections Visible -->
<div class="container mt-5">
  <div class="row">
    <div class="col-12">
      <h1 class="display-4 mb-4 text-center text-primary">Admin Dashboard</h1>
      <p class="lead text-center text-muted">Control center for moderation tasks and platform overview</p>
    </div>
  </div>

  <hr>

  <!-- USERS SECTION -->
  <div class="section mb-5">
    <div class="card shadow-sm">
      <div class="card-header bg-light">
        <h4 class="mb-0">User Accounts Management</h4>
      </div>
      <div class="card-body">
        <!-- Loading State -->
        <div *ngIf="isLoadingUsers" class="text-center p-3">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading users...</span>
          </div>
        </div>
        
        <!-- Users Table -->
        <div *ngIf="!isLoadingUsers" class="table-responsive">
          <table class="table table-hover align-middle">
            <thead>
              <tr>
                <th>ID</th>
                <th>Username</th>
                <th>Email</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let user of users">
                <td>{{ user.id }}</td>
                <td>
                  <a [routerLink]="['/profile', user.id]" class="text-decoration-none">
                    {{ user.username }}
                  </a>
                </td>
                <td>{{ user.email || 'N/A' }}</td>
                <td>
                  <span *ngIf="!user.isBlocked" class="badge bg-success">Active</span>
                  <span *ngIf="user.isBlocked" class="badge bg-danger">Banned</span>
                </td>
                <td>
                  <button 
                    *ngIf="!user.isBlocked" 
                    class="btn btn-warning btn-sm me-2" 
                    (click)="banUser(user)" 
                    title="Ban User">
                    <i class="bi bi-person-slash"></i> Ban
                  </button>
                  
                  <button 
                    *ngIf="user.isBlocked" 
                    class="btn btn-success btn-sm me-2" 
                    (click)="unbanUser(user)" 
                    title="Unban User">
                    <i class="bi bi-person-check"></i> Unban
                  </button>
                  
                  <button 
                    class="btn btn-danger btn-sm" 
                    (click)="deleteUser(user)" 
                    title="Delete User">
                    <i class="bi bi-trash"></i> Delete
                  </button>
                </td>
              </tr>
              <tr *ngIf="users.length === 0">
                <td colspan="5" class="text-center">No users found</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  
  <!-- POSTS SECTION -->
  <div class="section mb-5">
    <div class="card shadow-sm">
      <div class="card-header bg-light">
        <h4 class="mb-0">Content Moderation (Posts)</h4>
      </div>
      <div class="card-body">
        <!-- Loading State -->
        <div *ngIf="isLoadingPosts" class="text-center p-3">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading posts...</span>
          </div>
        </div>
        
        <!-- Posts Table -->
        <div *ngIf="!isLoadingPosts" class="table-responsive">
          <table class="table table-hover align-middle">
            <thead>
              <tr>
                <th>ID</th>
                <th>Author</th>
                <th>Content Preview</th>
                <th>Likes</th>
                <th>Comments</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let post of posts" [class.table-warning]="post.isHidden">
                <td>{{ post.id }}</td>
                <td>{{ post.authorUsername }}</td>
                <td>{{ post.content | slice:0:50 }}{{ post.content.length > 50 ? '...' : '' }}</td>
                <td>{{ post.likeCount }}</td>
                <td>{{ post.commentCount || 0 }}</td>
                <td>
                  <span *ngIf="!post.isHidden" class="badge bg-success">Visible</span>
                  <span *ngIf="post.isHidden" class="badge bg-warning text-dark">Hidden</span>
                </td>
                <td>
                  <!-- âœ… UPDATED: Hide/Unhide button now calls toggleHidePost -->
                  <button 
                    class="btn btn-sm me-2" 
                    [class.btn-warning]="!post.isHidden"
                    [class.btn-info]="post.isHidden"
                    (click)="toggleHidePost(post.id)"
                    [title]="post.isHidden ? 'Unhide Post' : 'Hide Post'">
                    <i [class]="post.isHidden ? 'bi bi-eye' : 'bi bi-eye-slash'"></i>
                    {{ post.isHidden ? 'Unhide' : 'Hide' }}
                  </button>
                  
                  <button 
                    class="btn btn-danger btn-sm" 
                    (click)="deletePost(post.id)" 
                    title="Delete Post">
                    <i class="bi bi-trash"></i> Delete
                  </button>
                </td>
              </tr>
              <tr *ngIf="posts.length === 0">
                <td colspan="7" class="text-center">No posts found</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  
  <!-- REPORTS SECTION -->
  <div class="section">
    <div class="card shadow-sm">
      <div class="card-header bg-light">
        <h4 class="mb-0">Submitted Reports</h4>
      </div>
      <div class="card-body">
        <!-- Loading State -->
        <div *ngIf="isLoadingReports" class="text-center p-3">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading reports...</span>
          </div>
        </div>
        
        <!-- Empty State -->
        <div *ngIf="!isLoadingReports && reports.length === 0" class="text-center p-3">
          <p class="text-muted">No reports to review</p>
        </div>
        
        <!-- Reports Table -->
        <div *ngIf="!isLoadingReports && reports.length > 0" class="table-responsive">
          <table class="table table-hover align-middle">
            <thead>
              <tr>
                <th>Report ID</th>
                <th>Reporter</th>
                <th>Target Type</th>
                <th>Target ID</th>
                <th>Reason</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let report of reports">
                <td>{{ report.id }}</td>
                <td>{{ getReporterUsername(report) }}</td>
                <td>
                  <span class="badge bg-info">{{ report.targetType === 'USER' ? 'Profile' : report.targetType }}</span>
                </td>
                <td>{{ report.targetId }}</td>
                <td>{{ report.reason | slice:0:50 }}{{ report.reason.length > 50 ? '...' : '' }}</td>
                <td>
                  <span *ngIf="report.status === 'NEW'" class="badge bg-warning">New</span>
                  <span *ngIf="report.status === 'REVIEWED'" class="badge bg-success">Reviewed</span>
                </td>
                <td>
                  <button 
                    *ngIf="report.status === 'NEW'" 
                    class="btn btn-primary btn-sm" 
                    (click)="reviewReport(report)" 
                    title="Mark as Reviewed">
                    <i class="bi bi-check-circle"></i> Review
                  </button>
                  <span *ngIf="report.status === 'REVIEWED'" class="text-muted">Reviewed</span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  
</div>